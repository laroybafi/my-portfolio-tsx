{"version":3,"sources":["../../src/server/next.ts"],"names":["addRequestMeta","url","log","loadConfig","resolve","NON_STANDARD_NODE_ENV","PHASE_DEVELOPMENT_SERVER","PHASE_PRODUCTION_SERVER","getTracer","NextServerSpan","formatUrl","proxyRequest","ServerImpl","getServerImpl","undefined","Promise","require","default","SYMBOL_SET_STANDALONE_MODE","Symbol","SYMBOL_LOAD_CONFIG","NextServer","constructor","options","hostname","port","standaloneMode","getRequestHandler","req","res","parsedUrl","trace","requestHandler","getServerRequestHandler","getUpgradeHandler","socket","head","server","getServer","handleUpgrade","apply","setAssetPrefix","assetPrefix","preparedAssetPrefix","logError","args","render","renderToHTML","renderError","renderErrorToHTML","render404","prepare","serverFields","Object","assign","dev","close","createServer","ServerImplementation","preloadedConfig","dir","conf","_renderWorker","serverPromise","then","process","env","__NEXT_PRIVATE_STANDALONE_CONFIG","JSON","stringify","output","warn","Error","reqHandler","reqHandlerPromise","wrap","bind","typescript","createTSPlugin","NODE_ENV","includes","console","customServer","shouldUseStandaloneMode","createRouterWorker","checkIsNodeDebugging","didWebSocketSetup","serverPort","setupWebSocketHandler","_req","error","on","parse","Proxy","get","_","propKey","isNodeDebugging","routerWorker","initResult","initialize","workerType","minimalMode","handler","httpServer","proxyParsedUrl","encrypted","headers","query","pathname","startsWith","method","module","exports"],"mappings":"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"}