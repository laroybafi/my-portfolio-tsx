{"version":3,"sources":["../../../src/server/lib/route-resolver.ts"],"names":["url","path","http","findPageFile","getRequestMeta","setupDebug","getCloneableBody","findPagesDir","setupFsCheck","proxyRequest","getResolveRoutes","PERMANENT_REDIRECT_STATUS","splitCookiesString","toNodeOutgoingHttpHeaders","signalFromNodeResponse","getMiddlewareRouteMatcher","pipeReadable","debug","makeResolver","dir","nextConfig","middleware","serverAddr","fsChecker","dev","minimalMode","config","appDir","pagesDir","experimental","ensureCallback","item","result","type","Error","itemPath","pageExtensions","distDir","join","middlewareInfo","name","paths","files","map","file","process","cwd","wasm","assets","middlewareServerPort","Promise","resolve","srv","createServer","req","res","cloneableBody","run","require","edgeFunctionEntry","request","headers","method","i18n","basePath","trailingSlash","hostname","port","body","signal","useCache","onWarning","console","warn","key","value","response","toLowerCase","delete","cookies","cookie","append","Object","entries","undefined","setHeader","statusCode","status","end","err","error","on","address","listen","length","middlewareMatcher","matcher","regexp","originalSource","resolveRoutes","isNodeDebugging","workerType","pages","initialize","deleteCache","clearModuleContext","deleteAppClientCache","propagateServerField","resolveRoute","routeResult","Set","matchedOutput","bodyStream","parsedUrl","resHeaders","finished","pathname","query","keys","destination","format","protocol","cloneBodyStream","proxyTimeout"],"mappings":"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"}