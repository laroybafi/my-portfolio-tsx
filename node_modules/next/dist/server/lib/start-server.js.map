{"version":3,"sources":["../../../src/server/lib/start-server.ts"],"names":["checkIsNodeDebugging","createRouterWorker","startServer","debug","setupDebug","process","isNodeDebugging","execArgv","some","localArg","startsWith","env","NODE_OPTIONS","match","routerServerPath","jestWorkerPath","require","resolve","Worker","numWorkers","maxRetries","forkOptions","genRouterWorkerExecArgv","undefined","FORCE_COLOR","initialEnv","getNodeOptionsWithoutInspect","NEXT_CPU_PROF","__NEXT_PRIVATE_CPU_PROFILE","WATCHPACK_WATCHER_LIMIT","EXPERIMENTAL_TURBOPACK","exposedMethods","dir","nextConfig","prevDir","port","isDev","hostname","useWorkers","minimalMode","allowRetry","keepAliveTimeout","onStdout","onStderr","logReady","sockets","Set","worker","routerPort","handlersReady","handlersError","handlersPromise","Promise","reject","requestHandler","_req","_res","Error","upgradeHandler","_socket","_head","server","http","createServer","req","res","add","on","delete","err","statusCode","end","Log","error","url","console","socket","head","destroy","portRetryCount","code","warn","listen","exit","targetHost","addr","address","host","normalizedHostname","isIPv6","appUrl","debugPort","getDebugPort","info","ready","PORT","httpProxy","replace","routerWorker","cleanup","curWorker","_workerPool","_workers","_child","kill","didInitialize","_worker","signal","workerStdout","getStdout","workerStderr","getStderr","data","stdout","write","stderr","initializeResult","initialize","dev","workerType","compress","setupCompression","getProxyServer","pathname","targetUrl","proxyServer","createProxy","target","changeOrigin","ignorePath","xfwd","ws","followRedirects","_err","proxyRes","innerReq","innerRes","cleanupProxy","removeListener","once","urlParts","split","urlNoQuery","cleanUrl","normalizeRepeatedSlashes","setHeader","invokeRes","invokeRequest","headers","method","signalFromNodeResponse","getCloneableBody","cloneBodyStream","e","isAbortError","status","statusMessage","statusText","key","value","Object","entries","filterReqHeaders","toNodeOutgoingHttpHeaders","ipcForbiddenHeaders","curValue","getHeader","newValue","cookie","Array","isArray","splitCookiesString","push","val","body","pipeReadable","proxyReq","next","app","httpServer","customServer","getRequestHandler","getUpgradeHandler","prepare","teardown","close","forEach"],"mappings":"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"}